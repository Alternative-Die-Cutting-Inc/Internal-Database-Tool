var AppModule=angular.module("app",[]);AppModule.directive("ngModelOnblur",function(e){return{restrict:"A",link:function(t,n,r,i){n.unbind("input").unbind("keydown").unbind("change");n.bind("blur",function(){t.$apply(function(){var t=n[0].name,i=n[0].value,s=r.ngTable;QT.setMasterRate(i,t,s,e)})})}}});AppModule.directive("userInput",function(e){return{restrict:"A",link:function(e,t,n,r){t.unbind("input").unbind("keydown").unbind("change");var i=function(){var r=n.column,i=n.quantityId,s=t[0].value,o=[{col:r,val:s}];e.quoteQuantities[i][r]=s;switch(r){case"units":var u=s,a=e.quoteQuantities[i].units_per_sheet;if(a!=0){var f=Math.ceil(u/a);e.saveValues([{col:"sheets",val:f}],i);e.recalculateSheets(i)}break;case"units_per_sheet":var u=e.quoteQuantities[i].units,a=s;if(u!=0&&a!=0){var f=Math.ceil(u/a);e.saveValues([{col:"sheets",val:f}],i);e.recalculateSheets(i)}break;case"die":case"cutter":case"press_setup":case"gluer_setup":case"package_per_m_units":e.recalculateTotal(i,r);break;case"press_runspeed":e.recalculateTotalWithPerM(i,"press");break;case"gluer_runspeed":e.recalculateTotalWithPerM(i,"gluer");break;case"strip_runspeed":e.recalculateTotalWithPerM(i,"strip");break;case"handwork_runspeed":e.recalculateTotalWithPerM(i,"handwork");break;case"pickup_skids":case"delivery_skids":e.recalculateShipmentTotal(i,r);break;case"press_per_m":e.recalculateRate(i,"press");e.recalculateTotalWithPerM(i,"press");e.recalculateTotal(i,"die");e.recalculateTotal(i,"cutter");e.recalculateTotal(i,"press_setup");break;case"gluer_per_m":e.recalculateRate(i,"gluer");e.recalculateTotalWithPerM(i,"gluer");e.recalculateTotal(i,"gluer_setup");break;case"strip_per_m":e.recalculateRate(i,"strip");e.recalculateTotalWithPerM(i,"strip");break;case"handwork_per_m":e.recalculateRate(i,"handwork");e.recalculateTotalWithPerM(i,"handwork");e.recalculateTotalWithPerM(i,"fold");break;case"fold_per_m_units":e.recalculateTotal(i,"fold_per_m_units")}e.saveValues(o,i);e.calculateTotal(i)};t.bind("blur",function(){e.$apply(i())});t.bind("keydown keypress",function(t){if(t.which===13){e.$apply(i());n.column!=="private_notes"&&n.column!=="public_notes"&&t.preventDefault()}})}}});AppModule.directive("extraField",function(e){return{restrict:"A",link:function(e,t,n,r){t.unbind("input").unbind("keydown").unbind("change");var i=function(){var r=n.column,i=n.quantityId,s=n.extraId,o=t[0].value,u=e.quoteQuantities[i].units;e.quantityExtras[i][s][r]=o;e.setExtraField(i,s,r);if(u!=0)switch(r){case"cost":e.quantityExtras[i][s].cost_per_m=QT.inDollars(o*100/(u/1e3)/100);e.setExtraField(i,s,"cost_per_m");break;case"cost_per_m":e.quantityExtras[i][s].cost=QT.inDollars(100*o*(u/1e3)/100);e.setExtraField(i,s,"cost")}e.calculateTotal(i)};t.bind("blur",function(){e.$apply(i())});t.bind("keydown keypress",function(t){if(t.which===13){e.$apply(i());t.preventDefault()}})}}});AppModule.directive("selectOnClick",function(){return function(e,t,n){t.click(function(){t.select()})}});